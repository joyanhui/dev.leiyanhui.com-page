<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="NixOS å…¥é—¨å»ºè®®ï¼šä¸€å¤©ä¸Šæ‰‹ï¼Œä»å…¥é—¨åˆ°ç²¾é€š NixOS çš„å¼ºå¤§å’Œæ–¹ä¾¿æ¯‹åº¸ç½®ç–‘ï¼Œä½†å¾ˆå¤šæ–°äººâ€œæ­¢æ­¥äºå…¥é—¨â€å¹¶éå› ä¸ºnixosçœŸçš„éš¾ï¼Œè€Œæ˜¯è·¯å¾„èµ°é”™äº†ã€‚æœ¬æ–‡æ—¨åœ¨ä¸ºä½ æä¾›ä¸€æ¡ä¸æŠ˜è…¾ã€å¿«é€Ÿå…¥é—¨çš„æ¸è¿›å¼è·¯çº¿ã€‚\nä¸€ã€ å‡†å¤‡é˜¶æ®µï¼šä½ æ˜¯å¦é€‚åˆ NixOSï¼Ÿ åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š\nLinux åŸºç¡€ï¼šç†Ÿæ‚‰æ—¥å¸¸ Linux æ“ä½œï¼Œæœ‰ä¿®æ”¹ dotfiles çš„ç»éªŒï¼Œèƒ½è§£å†³å¸¸è§çš„ç³»ç»Ÿé—®é¢˜ã€‚ ç¼–ç¨‹æ€ç»´ï¼šä¸è¦æ±‚æ˜¯ç»éªŒç¨‹åºå‘˜ï¼Œä½†è‡³å°‘èƒ½çœ‹æ‡‚ç®€å•çš„ä»£ç é€»è¾‘ï¼ˆNix è¯­è¨€æœ¬è´¨ä¸Šæ˜¯å‡½æ•°å¼é…ç½®è¯­è¨€ï¼‰ã€‚ ç½‘ç»œç¯å¢ƒï¼šè‡³å…³é‡è¦ï¼ å¿…é¡»æœ‰ç¨³å®šçš„â€œç§‘ç ”ä¸Šç½‘â€æ‰‹æ®µï¼ˆå»ºè®®åœ¨è·¯ç”±å™¨å±‚çº§å®ç°ï¼Œæˆ–å‡†å¤‡å¥½å…¨å±€ä»£ç†ï¼‰ã€‚ äºŒã€ å®‰è£…ï¼šé€‰æ‹©æœ€ç®€å•çš„è·¯å¾„ ä¸è¦æŒ‘æˆ˜é«˜éš¾åº¦å®‰è£…ï¼\næ¨èæ–¹å¼ï¼šä¸‹è½½ NixOS GNOME Live ISOã€‚å®ƒæä¾›äº†å›¾å½¢åŒ–å®‰è£…ç•Œé¢ï¼‰ï¼Œå°±åƒå®‰è£… Ubuntu ä¸€æ ·ç®€å•ã€‚ ç½‘ç»œä»£ç†ï¼šå¦‚æœå®‰è£…è¿‡ç¨‹ä¸‹è½½ç¼“æ…¢ï¼Œå¯ä»¥åœ¨åŒå±€åŸŸç½‘æ‰‹æœºä¸Šå¼€å¯ä»£ç†å·¥å…·ï¼Œå¹¶åœ¨å®‰è£…ç¯å¢ƒä¸­é…ç½®ä»£ç†ã€‚ è¿›é˜¶æ–¹å¼ï¼šå¦‚æœä½ æœ‰ Arch Linux æ‰‹åŠ¨å®‰è£…ç»éªŒï¼Œå¯ä»¥å‚è€ƒ å®˜æ–¹å®‰è£…æŒ‡å—ã€‚ ä¸‰ã€ æ ¸å¿ƒå¿ƒæ³•ï¼šæ¸è¿›å¼è¿ç§»ï¼ˆæ‹’ç»ä¸€å£åƒèƒ–ï¼‰ è¿™æ˜¯æ–°æ‰‹æœ€å®¹æ˜“çŠ¯çš„é”™è¯¯ï¼šç¬¬ä¸€å¤©å°±æƒ³æå®šå…¨ç³»ç»Ÿçš„ Flake + Home Manager æ‰˜ç®¡ï¼Œæˆ–è€…ç›´æ¥ Clone åˆ«äººçš„å¤æ‚ä»“åº“ã€‚\né˜¶æ®µ 1ï¼šå…ˆè·‘èµ·æ¥ï¼ˆçº¯ configuration.nixï¼‰ åªä¿®æ”¹ /etc/nixos/configuration.nixã€‚ ä½¿ç”¨ environment.systemPackages å®‰è£…è½¯ä»¶ã€‚ ä¸´æ—¶ç”¨è½¯ä»¶ï¼šå­¦ä¼šä½¿ç”¨ nix-shell -p pkg_nameï¼Œéšç”¨éšè£…ï¼Œä¸ç”¨ä¸å ç©ºé—´ã€‚ é˜¶æ®µ 2ï¼šæ¥å—â€œè¿‡åº¦æ–¹æ¡ˆâ€ï¼ˆDocker & Flatpakï¼‰ ä¸è¦åœ¨åˆæœŸå¼ºæ±‚æ‰€æœ‰ä¸œè¥¿éƒ½ Nix åŒ–ã€‚ æœåŠ¡ç±»ï¼šæä¸å®šçš„ä¸€äº›æœåŠ¡ç±»çš„ä¾‹å¦‚nginx/æ•°æ®åº“/è¯­è¨€è¿è¡Œå¼€å‘ç¯å¢ƒï¼Œæš‚æ—¶ç›´æ¥ç”¨ Dockerã€‚ GUI è½¯ä»¶ï¼šNixpkgs é‡Œæ²¡æœ‰æˆ–æœ‰é—®é¢˜çš„ï¼Œå…ˆç”¨ Flatpakã€‚ AppImageï¼šçœ‹ä½ è¦ç”¨çš„è½¯ä»¶æœ‰æ²¡æœ‰Appimageæ ¼å¼ï¼Œå…ˆå¯¹ä»˜ä¸€ä¸‹ã€‚ é˜¶æ®µ 3ï¼šå¼•å…¥ Flake ä¸ Home Manager å½“ä½ ç†Ÿæ‚‰äº† Nix è¯­æ³•åï¼Œå†å°†é…ç½®é‡æ„ä¸º Flake ç»“æ„ã€‚ ä½¿ç”¨ Home Manager ç®¡ç†ç”¨æˆ·å±‚é¢çš„åº”ç”¨çš„é…ç½®é¡¹ã€‚ å›› : å®æˆ˜é…ç½®èŒƒä¾‹åº“ ä»¥ä¸‹ä»£ç ç‰‡æ®µæ¶µç›–äº†ä»ç³»ç»ŸåŸºç¡€åˆ°å¼€å‘ç¯å¢ƒçš„æ–¹æ–¹é¢é¢ï¼ŒæŒ‰éœ€æŸ¥é˜…ï¼Œä¸è¦å…¨ç›˜ç…§æŠ„ã€‚\n"><title>NixOS å…¥é—¨æŒ‡å—ï¼šä»æ–°æ‰‹åˆ°é«˜æ‰‹çš„æ¸è¿›å¼ä¹‹è·¯(ç¬¬äºŒç‰ˆ)</title><link rel=canonical href=https://dev.leiyanhui.com/nixos/entrynixos/><link rel=stylesheet href=/scss/style.min.86591c898bd806857815fbb8c47e8d3fed97c133b78e83d9bfc27b164dd0aa2b.css><meta property='og:title' content="NixOS å…¥é—¨æŒ‡å—ï¼šä»æ–°æ‰‹åˆ°é«˜æ‰‹çš„æ¸è¿›å¼ä¹‹è·¯(ç¬¬äºŒç‰ˆ)"><meta property='og:description' content="NixOS å…¥é—¨å»ºè®®ï¼šä¸€å¤©ä¸Šæ‰‹ï¼Œä»å…¥é—¨åˆ°ç²¾é€š NixOS çš„å¼ºå¤§å’Œæ–¹ä¾¿æ¯‹åº¸ç½®ç–‘ï¼Œä½†å¾ˆå¤šæ–°äººâ€œæ­¢æ­¥äºå…¥é—¨â€å¹¶éå› ä¸ºnixosçœŸçš„éš¾ï¼Œè€Œæ˜¯è·¯å¾„èµ°é”™äº†ã€‚æœ¬æ–‡æ—¨åœ¨ä¸ºä½ æä¾›ä¸€æ¡ä¸æŠ˜è…¾ã€å¿«é€Ÿå…¥é—¨çš„æ¸è¿›å¼è·¯çº¿ã€‚\nä¸€ã€ å‡†å¤‡é˜¶æ®µï¼šä½ æ˜¯å¦é€‚åˆ NixOSï¼Ÿ åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š\nLinux åŸºç¡€ï¼šç†Ÿæ‚‰æ—¥å¸¸ Linux æ“ä½œï¼Œæœ‰ä¿®æ”¹ dotfiles çš„ç»éªŒï¼Œèƒ½è§£å†³å¸¸è§çš„ç³»ç»Ÿé—®é¢˜ã€‚ ç¼–ç¨‹æ€ç»´ï¼šä¸è¦æ±‚æ˜¯ç»éªŒç¨‹åºå‘˜ï¼Œä½†è‡³å°‘èƒ½çœ‹æ‡‚ç®€å•çš„ä»£ç é€»è¾‘ï¼ˆNix è¯­è¨€æœ¬è´¨ä¸Šæ˜¯å‡½æ•°å¼é…ç½®è¯­è¨€ï¼‰ã€‚ ç½‘ç»œç¯å¢ƒï¼šè‡³å…³é‡è¦ï¼ å¿…é¡»æœ‰ç¨³å®šçš„â€œç§‘ç ”ä¸Šç½‘â€æ‰‹æ®µï¼ˆå»ºè®®åœ¨è·¯ç”±å™¨å±‚çº§å®ç°ï¼Œæˆ–å‡†å¤‡å¥½å…¨å±€ä»£ç†ï¼‰ã€‚ äºŒã€ å®‰è£…ï¼šé€‰æ‹©æœ€ç®€å•çš„è·¯å¾„ ä¸è¦æŒ‘æˆ˜é«˜éš¾åº¦å®‰è£…ï¼\næ¨èæ–¹å¼ï¼šä¸‹è½½ NixOS GNOME Live ISOã€‚å®ƒæä¾›äº†å›¾å½¢åŒ–å®‰è£…ç•Œé¢ï¼‰ï¼Œå°±åƒå®‰è£… Ubuntu ä¸€æ ·ç®€å•ã€‚ ç½‘ç»œä»£ç†ï¼šå¦‚æœå®‰è£…è¿‡ç¨‹ä¸‹è½½ç¼“æ…¢ï¼Œå¯ä»¥åœ¨åŒå±€åŸŸç½‘æ‰‹æœºä¸Šå¼€å¯ä»£ç†å·¥å…·ï¼Œå¹¶åœ¨å®‰è£…ç¯å¢ƒä¸­é…ç½®ä»£ç†ã€‚ è¿›é˜¶æ–¹å¼ï¼šå¦‚æœä½ æœ‰ Arch Linux æ‰‹åŠ¨å®‰è£…ç»éªŒï¼Œå¯ä»¥å‚è€ƒ å®˜æ–¹å®‰è£…æŒ‡å—ã€‚ ä¸‰ã€ æ ¸å¿ƒå¿ƒæ³•ï¼šæ¸è¿›å¼è¿ç§»ï¼ˆæ‹’ç»ä¸€å£åƒèƒ–ï¼‰ è¿™æ˜¯æ–°æ‰‹æœ€å®¹æ˜“çŠ¯çš„é”™è¯¯ï¼šç¬¬ä¸€å¤©å°±æƒ³æå®šå…¨ç³»ç»Ÿçš„ Flake + Home Manager æ‰˜ç®¡ï¼Œæˆ–è€…ç›´æ¥ Clone åˆ«äººçš„å¤æ‚ä»“åº“ã€‚\né˜¶æ®µ 1ï¼šå…ˆè·‘èµ·æ¥ï¼ˆçº¯ configuration.nixï¼‰ åªä¿®æ”¹ /etc/nixos/configuration.nixã€‚ ä½¿ç”¨ environment.systemPackages å®‰è£…è½¯ä»¶ã€‚ ä¸´æ—¶ç”¨è½¯ä»¶ï¼šå­¦ä¼šä½¿ç”¨ nix-shell -p pkg_nameï¼Œéšç”¨éšè£…ï¼Œä¸ç”¨ä¸å ç©ºé—´ã€‚ é˜¶æ®µ 2ï¼šæ¥å—â€œè¿‡åº¦æ–¹æ¡ˆâ€ï¼ˆDocker & Flatpakï¼‰ ä¸è¦åœ¨åˆæœŸå¼ºæ±‚æ‰€æœ‰ä¸œè¥¿éƒ½ Nix åŒ–ã€‚ æœåŠ¡ç±»ï¼šæä¸å®šçš„ä¸€äº›æœåŠ¡ç±»çš„ä¾‹å¦‚nginx/æ•°æ®åº“/è¯­è¨€è¿è¡Œå¼€å‘ç¯å¢ƒï¼Œæš‚æ—¶ç›´æ¥ç”¨ Dockerã€‚ GUI è½¯ä»¶ï¼šNixpkgs é‡Œæ²¡æœ‰æˆ–æœ‰é—®é¢˜çš„ï¼Œå…ˆç”¨ Flatpakã€‚ AppImageï¼šçœ‹ä½ è¦ç”¨çš„è½¯ä»¶æœ‰æ²¡æœ‰Appimageæ ¼å¼ï¼Œå…ˆå¯¹ä»˜ä¸€ä¸‹ã€‚ é˜¶æ®µ 3ï¼šå¼•å…¥ Flake ä¸ Home Manager å½“ä½ ç†Ÿæ‚‰äº† Nix è¯­æ³•åï¼Œå†å°†é…ç½®é‡æ„ä¸º Flake ç»“æ„ã€‚ ä½¿ç”¨ Home Manager ç®¡ç†ç”¨æˆ·å±‚é¢çš„åº”ç”¨çš„é…ç½®é¡¹ã€‚ å›› : å®æˆ˜é…ç½®èŒƒä¾‹åº“ ä»¥ä¸‹ä»£ç ç‰‡æ®µæ¶µç›–äº†ä»ç³»ç»ŸåŸºç¡€åˆ°å¼€å‘ç¯å¢ƒçš„æ–¹æ–¹é¢é¢ï¼ŒæŒ‰éœ€æŸ¥é˜…ï¼Œä¸è¦å…¨ç›˜ç…§æŠ„ã€‚\n"><meta property='og:url' content='https://dev.leiyanhui.com/nixos/entrynixos/'><meta property='og:site_name' content='å°ç±»éšæ‰‹è®°'><meta property='og:type' content='article'><meta property='article:section' content='Nixos'><meta property='article:published_time' content='2026-01-04T00:00:00+00:00'><meta property='article:modified_time' content='2026-01-04T00:00:00+00:00'><meta name=twitter:title content="NixOS å…¥é—¨æŒ‡å—ï¼šä»æ–°æ‰‹åˆ°é«˜æ‰‹çš„æ¸è¿›å¼ä¹‹è·¯(ç¬¬äºŒç‰ˆ)"><meta name=twitter:description content="NixOS å…¥é—¨å»ºè®®ï¼šä¸€å¤©ä¸Šæ‰‹ï¼Œä»å…¥é—¨åˆ°ç²¾é€š NixOS çš„å¼ºå¤§å’Œæ–¹ä¾¿æ¯‹åº¸ç½®ç–‘ï¼Œä½†å¾ˆå¤šæ–°äººâ€œæ­¢æ­¥äºå…¥é—¨â€å¹¶éå› ä¸ºnixosçœŸçš„éš¾ï¼Œè€Œæ˜¯è·¯å¾„èµ°é”™äº†ã€‚æœ¬æ–‡æ—¨åœ¨ä¸ºä½ æä¾›ä¸€æ¡ä¸æŠ˜è…¾ã€å¿«é€Ÿå…¥é—¨çš„æ¸è¿›å¼è·¯çº¿ã€‚\nä¸€ã€ å‡†å¤‡é˜¶æ®µï¼šä½ æ˜¯å¦é€‚åˆ NixOSï¼Ÿ åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š\nLinux åŸºç¡€ï¼šç†Ÿæ‚‰æ—¥å¸¸ Linux æ“ä½œï¼Œæœ‰ä¿®æ”¹ dotfiles çš„ç»éªŒï¼Œèƒ½è§£å†³å¸¸è§çš„ç³»ç»Ÿé—®é¢˜ã€‚ ç¼–ç¨‹æ€ç»´ï¼šä¸è¦æ±‚æ˜¯ç»éªŒç¨‹åºå‘˜ï¼Œä½†è‡³å°‘èƒ½çœ‹æ‡‚ç®€å•çš„ä»£ç é€»è¾‘ï¼ˆNix è¯­è¨€æœ¬è´¨ä¸Šæ˜¯å‡½æ•°å¼é…ç½®è¯­è¨€ï¼‰ã€‚ ç½‘ç»œç¯å¢ƒï¼šè‡³å…³é‡è¦ï¼ å¿…é¡»æœ‰ç¨³å®šçš„â€œç§‘ç ”ä¸Šç½‘â€æ‰‹æ®µï¼ˆå»ºè®®åœ¨è·¯ç”±å™¨å±‚çº§å®ç°ï¼Œæˆ–å‡†å¤‡å¥½å…¨å±€ä»£ç†ï¼‰ã€‚ äºŒã€ å®‰è£…ï¼šé€‰æ‹©æœ€ç®€å•çš„è·¯å¾„ ä¸è¦æŒ‘æˆ˜é«˜éš¾åº¦å®‰è£…ï¼\næ¨èæ–¹å¼ï¼šä¸‹è½½ NixOS GNOME Live ISOã€‚å®ƒæä¾›äº†å›¾å½¢åŒ–å®‰è£…ç•Œé¢ï¼‰ï¼Œå°±åƒå®‰è£… Ubuntu ä¸€æ ·ç®€å•ã€‚ ç½‘ç»œä»£ç†ï¼šå¦‚æœå®‰è£…è¿‡ç¨‹ä¸‹è½½ç¼“æ…¢ï¼Œå¯ä»¥åœ¨åŒå±€åŸŸç½‘æ‰‹æœºä¸Šå¼€å¯ä»£ç†å·¥å…·ï¼Œå¹¶åœ¨å®‰è£…ç¯å¢ƒä¸­é…ç½®ä»£ç†ã€‚ è¿›é˜¶æ–¹å¼ï¼šå¦‚æœä½ æœ‰ Arch Linux æ‰‹åŠ¨å®‰è£…ç»éªŒï¼Œå¯ä»¥å‚è€ƒ å®˜æ–¹å®‰è£…æŒ‡å—ã€‚ ä¸‰ã€ æ ¸å¿ƒå¿ƒæ³•ï¼šæ¸è¿›å¼è¿ç§»ï¼ˆæ‹’ç»ä¸€å£åƒèƒ–ï¼‰ è¿™æ˜¯æ–°æ‰‹æœ€å®¹æ˜“çŠ¯çš„é”™è¯¯ï¼šç¬¬ä¸€å¤©å°±æƒ³æå®šå…¨ç³»ç»Ÿçš„ Flake + Home Manager æ‰˜ç®¡ï¼Œæˆ–è€…ç›´æ¥ Clone åˆ«äººçš„å¤æ‚ä»“åº“ã€‚\né˜¶æ®µ 1ï¼šå…ˆè·‘èµ·æ¥ï¼ˆçº¯ configuration.nixï¼‰ åªä¿®æ”¹ /etc/nixos/configuration.nixã€‚ ä½¿ç”¨ environment.systemPackages å®‰è£…è½¯ä»¶ã€‚ ä¸´æ—¶ç”¨è½¯ä»¶ï¼šå­¦ä¼šä½¿ç”¨ nix-shell -p pkg_nameï¼Œéšç”¨éšè£…ï¼Œä¸ç”¨ä¸å ç©ºé—´ã€‚ é˜¶æ®µ 2ï¼šæ¥å—â€œè¿‡åº¦æ–¹æ¡ˆâ€ï¼ˆDocker & Flatpakï¼‰ ä¸è¦åœ¨åˆæœŸå¼ºæ±‚æ‰€æœ‰ä¸œè¥¿éƒ½ Nix åŒ–ã€‚ æœåŠ¡ç±»ï¼šæä¸å®šçš„ä¸€äº›æœåŠ¡ç±»çš„ä¾‹å¦‚nginx/æ•°æ®åº“/è¯­è¨€è¿è¡Œå¼€å‘ç¯å¢ƒï¼Œæš‚æ—¶ç›´æ¥ç”¨ Dockerã€‚ GUI è½¯ä»¶ï¼šNixpkgs é‡Œæ²¡æœ‰æˆ–æœ‰é—®é¢˜çš„ï¼Œå…ˆç”¨ Flatpakã€‚ AppImageï¼šçœ‹ä½ è¦ç”¨çš„è½¯ä»¶æœ‰æ²¡æœ‰Appimageæ ¼å¼ï¼Œå…ˆå¯¹ä»˜ä¸€ä¸‹ã€‚ é˜¶æ®µ 3ï¼šå¼•å…¥ Flake ä¸ Home Manager å½“ä½ ç†Ÿæ‚‰äº† Nix è¯­æ³•åï¼Œå†å°†é…ç½®é‡æ„ä¸º Flake ç»“æ„ã€‚ ä½¿ç”¨ Home Manager ç®¡ç†ç”¨æˆ·å±‚é¢çš„åº”ç”¨çš„é…ç½®é¡¹ã€‚ å›› : å®æˆ˜é…ç½®èŒƒä¾‹åº“ ä»¥ä¸‹ä»£ç ç‰‡æ®µæ¶µç›–äº†ä»ç³»ç»ŸåŸºç¡€åˆ°å¼€å‘ç¯å¢ƒçš„æ–¹æ–¹é¢é¢ï¼ŒæŒ‰éœ€æŸ¥é˜…ï¼Œä¸è¦å…¨ç›˜ç…§æŠ„ã€‚\n"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_131d47a3a5694d37.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸŸ</span></figure><div class=site-meta><h1 class=site-name><a href=/>å°ç±»éšæ‰‹è®°</a></h1><h2 class=site-description>just so so.</h2></div></header><ol class=menu-social><li><a href=https://github.com/joyanhui/dev.leiyanhui.com-src target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>åˆ—è¡¨</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>ç«™å†…æœç´¢</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>links</span></a></li><li><a href=/contact/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>contact</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#ä¸€-å‡†å¤‡é˜¶æ®µä½ æ˜¯å¦é€‚åˆ-nixos>ä¸€ã€ å‡†å¤‡é˜¶æ®µï¼šä½ æ˜¯å¦é€‚åˆ NixOSï¼Ÿ</a></li><li><a href=#äºŒ-å®‰è£…é€‰æ‹©æœ€ç®€å•çš„è·¯å¾„>äºŒã€ å®‰è£…ï¼šé€‰æ‹©æœ€ç®€å•çš„è·¯å¾„</a></li><li><a href=#ä¸‰-æ ¸å¿ƒå¿ƒæ³•æ¸è¿›å¼è¿ç§»æ‹’ç»ä¸€å£åƒèƒ–>ä¸‰ã€ æ ¸å¿ƒå¿ƒæ³•ï¼šæ¸è¿›å¼è¿ç§»ï¼ˆæ‹’ç»ä¸€å£åƒèƒ–ï¼‰</a><ol><li><a href=#é˜¶æ®µ-1å…ˆè·‘èµ·æ¥çº¯-configurationnix>é˜¶æ®µ 1ï¼šå…ˆè·‘èµ·æ¥ï¼ˆçº¯ <code>configuration.nix</code>ï¼‰</a></li><li><a href=#é˜¶æ®µ-2æ¥å—è¿‡åº¦æ–¹æ¡ˆdocker--flatpak>é˜¶æ®µ 2ï¼šæ¥å—â€œè¿‡åº¦æ–¹æ¡ˆâ€ï¼ˆDocker & Flatpakï¼‰</a></li><li><a href=#é˜¶æ®µ-3å¼•å…¥-flake-ä¸-home-manager>é˜¶æ®µ 3ï¼šå¼•å…¥ Flake ä¸ Home Manager</a></li></ol></li><li><a href=#å››--å®æˆ˜é…ç½®èŒƒä¾‹åº“>å›› : å®æˆ˜é…ç½®èŒƒä¾‹åº“</a><ol><li><a href=#1-åŸºç¡€flake-ç»“æ„-flakenix>1. åŸºç¡€Flake ç»“æ„ (<code>flake.nix</code>)</a></li><li><a href=#2-ç°ä»£-linux-å¿…å¤‡docker-ä¸-flatpak-é…ç½®>2. ç°ä»£ Linux å¿…å¤‡ï¼šDocker ä¸ Flatpak é…ç½®</a></li><li><a href=#3-å­—ä½“ä¸å›½é™…åŒ–-ä¸­æ–‡ç¯å¢ƒ>3. å­—ä½“ä¸å›½é™…åŒ– (ä¸­æ–‡ç¯å¢ƒ)</a></li><li><a href=#4-è¾“å…¥æ³•-fcitx5--é›¾å‡‡æ‹¼éŸ³>4. è¾“å…¥æ³• (Fcitx5 + é›¾å‡‡æ‹¼éŸ³)</a><ol><li><a href=#41-ä¸»é…ç½®-fcitx5-rimenix>4.1 ä¸»é…ç½® (<code>fcitx5-rime.nix</code>)</a></li><li><a href=#42-ç¯å¢ƒå˜é‡é…ç½®-fcitx5-sessionvariablesnix>4.2 ç¯å¢ƒå˜é‡é…ç½® (<code>fcitx5-sessionVariables.nix</code>)</a></li></ol></li><li><a href=#5-å¼€å‘ç¯å¢ƒç¤ºä¾‹-åˆ†è¯­è¨€é…ç½®>5. å¼€å‘ç¯å¢ƒç¤ºä¾‹ (åˆ†è¯­è¨€é…ç½®)</a><ol><li><a href=#51-é€šç”¨-cc-ä¸å›¾å½¢å¼€å‘åŸºç¡€-lang-commonnix>5.1 é€šç”¨ C/C++ ä¸å›¾å½¢å¼€å‘åŸºç¡€ (<code>lang-common.nix</code>)</a></li><li><a href=#52-rust-ç¯å¢ƒ-rustnix>5.2 Rust ç¯å¢ƒ (<code>rust.nix</code>)</a></li><li><a href=#53-go-ç¯å¢ƒ-golangnix>5.3 Go ç¯å¢ƒ (<code>golang.nix</code>)</a></li><li><a href=#54-nodejs--bun--deno-nodenix>5.4 Node.js / Bun / Deno (<code>node.nix</code>)</a></li><li><a href=#55-python-ä¸-zig>5.5 Python ä¸ Zig</a></li><li><a href=#56-ç»Ÿä¸€ç®¡ç†ç¯å¢ƒå˜é‡>5.6 ç»Ÿä¸€ç®¡ç†ç¯å¢ƒå˜é‡</a></li></ol></li></ol></li><li><a href=#äº”-ç¤¾åŒºä¸æ±‚åŠ©>äº”ã€ ç¤¾åŒºä¸æ±‚åŠ©</a></li><li><a href=#æ€»ç»“>æ€»ç»“</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/nixos/ style=background-color:#beefcc;color:#0f3d1d>Nixos</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/nixos/entrynixos/>NixOS å…¥é—¨æŒ‡å—ï¼šä»æ–°æ‰‹åˆ°é«˜æ‰‹çš„æ¸è¿›å¼ä¹‹è·¯(ç¬¬äºŒç‰ˆ)</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2026-01-04T00:00:00Z>2026-01-04</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 7 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><h1 id=nixos-å…¥é—¨å»ºè®®ä¸€å¤©ä¸Šæ‰‹ä»å…¥é—¨åˆ°ç²¾é€š>NixOS å…¥é—¨å»ºè®®ï¼šä¸€å¤©ä¸Šæ‰‹ï¼Œä»å…¥é—¨åˆ°ç²¾é€š</h1><p>NixOS çš„å¼ºå¤§å’Œæ–¹ä¾¿æ¯‹åº¸ç½®ç–‘ï¼Œä½†å¾ˆå¤šæ–°äººâ€œæ­¢æ­¥äºå…¥é—¨â€å¹¶éå› ä¸ºnixosçœŸçš„éš¾ï¼Œè€Œæ˜¯<strong>è·¯å¾„èµ°é”™äº†</strong>ã€‚æœ¬æ–‡æ—¨åœ¨ä¸ºä½ æä¾›ä¸€æ¡ä¸æŠ˜è…¾ã€å¿«é€Ÿå…¥é—¨çš„æ¸è¿›å¼è·¯çº¿ã€‚</p><hr><h2 id=ä¸€-å‡†å¤‡é˜¶æ®µä½ æ˜¯å¦é€‚åˆ-nixos>ä¸€ã€ å‡†å¤‡é˜¶æ®µï¼šä½ æ˜¯å¦é€‚åˆ NixOSï¼Ÿ</h2><p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><ol><li><strong>Linux åŸºç¡€</strong>ï¼šç†Ÿæ‚‰æ—¥å¸¸ Linux æ“ä½œï¼Œæœ‰ä¿®æ”¹ <code>dotfiles</code> çš„ç»éªŒï¼Œèƒ½è§£å†³å¸¸è§çš„ç³»ç»Ÿé—®é¢˜ã€‚</li><li><strong>ç¼–ç¨‹æ€ç»´</strong>ï¼šä¸è¦æ±‚æ˜¯ç»éªŒç¨‹åºå‘˜ï¼Œä½†è‡³å°‘èƒ½çœ‹æ‡‚ç®€å•çš„ä»£ç é€»è¾‘ï¼ˆNix è¯­è¨€æœ¬è´¨ä¸Šæ˜¯å‡½æ•°å¼é…ç½®è¯­è¨€ï¼‰ã€‚</li><li><strong>ç½‘ç»œç¯å¢ƒ</strong>ï¼š<strong>è‡³å…³é‡è¦ï¼</strong> å¿…é¡»æœ‰ç¨³å®šçš„â€œç§‘ç ”ä¸Šç½‘â€æ‰‹æ®µï¼ˆå»ºè®®åœ¨è·¯ç”±å™¨å±‚çº§å®ç°ï¼Œæˆ–å‡†å¤‡å¥½å…¨å±€ä»£ç†ï¼‰ã€‚</li></ol><hr><h2 id=äºŒ-å®‰è£…é€‰æ‹©æœ€ç®€å•çš„è·¯å¾„>äºŒã€ å®‰è£…ï¼šé€‰æ‹©æœ€ç®€å•çš„è·¯å¾„</h2><p><strong>ä¸è¦æŒ‘æˆ˜é«˜éš¾åº¦å®‰è£…ï¼</strong></p><ul><li><strong>æ¨èæ–¹å¼</strong>ï¼šä¸‹è½½ <strong>NixOS GNOME Live ISO</strong>ã€‚å®ƒæä¾›äº†å›¾å½¢åŒ–å®‰è£…ç•Œé¢ï¼‰ï¼Œå°±åƒå®‰è£… Ubuntu ä¸€æ ·ç®€å•ã€‚</li><li><strong>ç½‘ç»œä»£ç†</strong>ï¼šå¦‚æœå®‰è£…è¿‡ç¨‹ä¸‹è½½ç¼“æ…¢ï¼Œå¯ä»¥åœ¨åŒå±€åŸŸç½‘æ‰‹æœºä¸Šå¼€å¯ä»£ç†å·¥å…·ï¼Œå¹¶åœ¨å®‰è£…ç¯å¢ƒä¸­é…ç½®ä»£ç†ã€‚</li><li><strong>è¿›é˜¶æ–¹å¼</strong>ï¼šå¦‚æœä½ æœ‰ Arch Linux æ‰‹åŠ¨å®‰è£…ç»éªŒï¼Œå¯ä»¥å‚è€ƒ <a class=link href=https://wiki.nixos.org/wiki/NixOS_Installation_Guide/zh target=_blank rel=noopener>å®˜æ–¹å®‰è£…æŒ‡å—</a>ã€‚</li></ul><hr><h2 id=ä¸‰-æ ¸å¿ƒå¿ƒæ³•æ¸è¿›å¼è¿ç§»æ‹’ç»ä¸€å£åƒèƒ–>ä¸‰ã€ æ ¸å¿ƒå¿ƒæ³•ï¼šæ¸è¿›å¼è¿ç§»ï¼ˆæ‹’ç»ä¸€å£åƒèƒ–ï¼‰</h2><p><strong>è¿™æ˜¯æ–°æ‰‹æœ€å®¹æ˜“çŠ¯çš„é”™è¯¯ï¼šç¬¬ä¸€å¤©å°±æƒ³æå®šå…¨ç³»ç»Ÿçš„ Flake + Home Manager æ‰˜ç®¡ï¼Œæˆ–è€…ç›´æ¥ Clone åˆ«äººçš„å¤æ‚ä»“åº“ã€‚</strong></p><h3 id=é˜¶æ®µ-1å…ˆè·‘èµ·æ¥çº¯-configurationnix>é˜¶æ®µ 1ï¼šå…ˆè·‘èµ·æ¥ï¼ˆçº¯ <code>configuration.nix</code>ï¼‰</h3><ul><li>åªä¿®æ”¹ <code>/etc/nixos/configuration.nix</code>ã€‚</li><li>ä½¿ç”¨ <code>environment.systemPackages</code> å®‰è£…è½¯ä»¶ã€‚</li><li><strong>ä¸´æ—¶ç”¨è½¯ä»¶</strong>ï¼šå­¦ä¼šä½¿ç”¨ <code>nix-shell -p pkg_name</code>ï¼Œéšç”¨éšè£…ï¼Œä¸ç”¨ä¸å ç©ºé—´ã€‚</li></ul><h3 id=é˜¶æ®µ-2æ¥å—è¿‡åº¦æ–¹æ¡ˆdocker--flatpak>é˜¶æ®µ 2ï¼šæ¥å—â€œè¿‡åº¦æ–¹æ¡ˆâ€ï¼ˆDocker & Flatpakï¼‰</h3><ul><li><strong>ä¸è¦åœ¨åˆæœŸå¼ºæ±‚æ‰€æœ‰ä¸œè¥¿éƒ½ Nix åŒ–</strong>ã€‚</li><li><strong>æœåŠ¡ç±»</strong>ï¼šæä¸å®šçš„ä¸€äº›æœåŠ¡ç±»çš„ä¾‹å¦‚nginx/æ•°æ®åº“/è¯­è¨€è¿è¡Œå¼€å‘ç¯å¢ƒï¼Œæš‚æ—¶ç›´æ¥ç”¨ <strong>Docker</strong>ã€‚</li><li><strong>GUI è½¯ä»¶</strong>ï¼šNixpkgs é‡Œæ²¡æœ‰æˆ–æœ‰é—®é¢˜çš„ï¼Œå…ˆç”¨ <strong>Flatpak</strong>ã€‚</li><li><strong>AppImage</strong>ï¼šçœ‹ä½ è¦ç”¨çš„è½¯ä»¶æœ‰æ²¡æœ‰Appimageæ ¼å¼ï¼Œå…ˆå¯¹ä»˜ä¸€ä¸‹ã€‚</li></ul><h3 id=é˜¶æ®µ-3å¼•å…¥-flake-ä¸-home-manager>é˜¶æ®µ 3ï¼šå¼•å…¥ Flake ä¸ Home Manager</h3><ul><li>å½“ä½ ç†Ÿæ‚‰äº† Nix è¯­æ³•åï¼Œå†å°†é…ç½®é‡æ„ä¸º Flake ç»“æ„ã€‚</li><li>ä½¿ç”¨ Home Manager ç®¡ç†ç”¨æˆ·å±‚é¢çš„åº”ç”¨çš„é…ç½®é¡¹ã€‚</li></ul><hr><h2 id=å››--å®æˆ˜é…ç½®èŒƒä¾‹åº“>å›› : å®æˆ˜é…ç½®èŒƒä¾‹åº“</h2><p>ä»¥ä¸‹ä»£ç ç‰‡æ®µæ¶µç›–äº†ä»ç³»ç»ŸåŸºç¡€åˆ°å¼€å‘ç¯å¢ƒçš„æ–¹æ–¹é¢é¢ï¼Œ<strong>æŒ‰éœ€æŸ¥é˜…ï¼Œä¸è¦å…¨ç›˜ç…§æŠ„</strong>ã€‚</p><h3 id=1-åŸºç¡€flake-ç»“æ„-flakenix>1. åŸºç¡€Flake ç»“æ„ (<code>flake.nix</code>)</h3><p>è¿™æ˜¯ç³»ç»Ÿçš„æ€»å…¥å£ï¼Œå»ºè®®æ”¾åœ¨ <code>~/nixos-config</code> ç›®å½•ä¸‹ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>inputs</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>nixpkgs</span><span class=o>.</span><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;github:NixOS/nixpkgs/nixos-unstable&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>nixpkgs-stable</span><span class=o>.</span><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;github:NixOS/nixpkgs/nixos-25.11&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>nixpkgs-master</span><span class=o>.</span><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;github:NixOS/nixpkgs/master&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>home-manager</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;github:nix-community/home-manager&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>inputs</span><span class=o>.</span><span class=n>nixpkgs</span><span class=o>.</span><span class=n>follows</span> <span class=o>=</span> <span class=s2>&#34;nixpkgs&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>outputs</span> <span class=o>=</span> <span class=n>inputs</span><span class=o>@</span><span class=p>{</span> <span class=n>nixpkgs</span><span class=o>,</span> <span class=n>home-manager</span><span class=o>,</span> <span class=o>...</span> <span class=p>}:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>nixosConfigurations</span><span class=o>.</span><span class=n>my-pc</span> <span class=o>=</span> <span class=n>nixpkgs</span><span class=o>.</span><span class=n>lib</span><span class=o>.</span><span class=n>nixosSystem</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>system</span> <span class=o>=</span> <span class=s2>&#34;x86_64-linux&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>modules</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=sr>./configuration.nix</span>  <span class=c1>#ä½ åŸæ¥çš„ /etc/nixos/configuration.nix</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=n>nixpkgs</span><span class=o>.</span><span class=n>overlays</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=n>final</span><span class=p>:</span> <span class=n>prev</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=n>stable</span> <span class=o>=</span> <span class=kn>import</span> <span class=n>inputs</span><span class=o>.</span><span class=n>nixpkgs-stable</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>system</span> <span class=o>=</span> <span class=n>prev</span><span class=o>.</span><span class=n>stdenv</span><span class=o>.</span><span class=n>hostPlatform</span><span class=o>.</span><span class=n>system</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>config</span><span class=o>.</span><span class=n>allowUnfree</span> <span class=o>=</span> <span class=no>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>              <span class=p>};</span>
</span></span><span class=line><span class=cl>              <span class=n>unstable</span> <span class=o>=</span> <span class=kn>import</span> <span class=n>inputs</span><span class=o>.</span><span class=n>nixpkgs</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>system</span> <span class=o>=</span> <span class=n>prev</span><span class=o>.</span><span class=n>stdenv</span><span class=o>.</span><span class=n>hostPlatform</span><span class=o>.</span><span class=n>system</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>config</span><span class=o>.</span><span class=n>allowUnfree</span> <span class=o>=</span> <span class=no>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>              <span class=p>};</span>
</span></span><span class=line><span class=cl>              <span class=n>master</span> <span class=o>=</span> <span class=kn>import</span> <span class=n>inputs</span><span class=o>.</span><span class=n>nixpkgs-master</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>system</span> <span class=o>=</span> <span class=n>prev</span><span class=o>.</span><span class=n>stdenv</span><span class=o>.</span><span class=n>hostPlatform</span><span class=o>.</span><span class=n>system</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>config</span><span class=o>.</span><span class=n>allowUnfree</span> <span class=o>=</span> <span class=no>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>              <span class=p>};</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>          <span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>home-manager</span><span class=o>.</span><span class=n>nixosModules</span><span class=o>.</span><span class=n>home-manager</span>
</span></span><span class=line><span class=cl>      <span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>specialArgs</span> <span class=o>=</span> <span class=p>{</span> <span class=k>inherit</span> <span class=n>inputs</span><span class=p>;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¸€ä¸ªå…¸å‹çš„ nixos-config æ–‡ä»¶ç»“æ„</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>â”œâ”€â”€ flake.nix               <span class=c1># ç³»ç»Ÿæ€»å…¥å£ï¼Œå®šä¹‰ inputs å’Œ outputs</span>
</span></span><span class=line><span class=cl>â”œâ”€â”€ flake.lock              <span class=c1># é”å®šä¾èµ–ç‰ˆæœ¬ åœ¨ nix flake updateçš„æ—¶å€™è‡ªåŠ¨åˆ›å»º</span>
</span></span><span class=line><span class=cl>â”œâ”€â”€ machine/                <span class=c1># ç¡¬ä»¶ä¸è®¾å¤‡ç‰¹å®šé…ç½®</span>
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ hardware-configuration_thinbook_14p_amd.nix <span class=c1>#ä½ åŸæ¥çš„ /etc/nixos/hardware-configuration.nix å¾®è°ƒ  thinbook_14p_amdæ˜¯ç”µè„‘å</span>
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ configuration_thinbook_14p_amd.nix <span class=c1># ä½ åŸæ¥çš„ /etc/nixos/configuration.nix å¾®è°ƒ å¹¶ä½œä¸º importå…¶ä»–æ–‡ä»¶çš„å…¥å£</span>
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ ....
</span></span><span class=line><span class=cl>â”‚   â””â”€â”€ subFileList.nix     <span class=c1># æ ¸å¿ƒè°ƒåº¦æ–‡ä»¶ï¼Œæ ¹æ®ä¸»æœºååŠ è½½ä¸åŒæ¨¡å— ä¹Ÿå¯ä»¥ä¸éœ€è¦è¿™ä¸ªæ–‡ä»¶ é›†æˆåˆ°configuration_XXX.nix</span>
</span></span><span class=line><span class=cl>â”œâ”€â”€ modules/                <span class=c1># æŒ‰åŠŸèƒ½åˆ’åˆ†çš„æ¨¡å—åŒ–é…ç½®</span>
</span></span><span class=line><span class=cl>â”‚   â”œâ”€â”€ application/        <span class=c1># æ—¥å¸¸åº”ç”¨ (æµè§ˆå™¨ã€èŠå¤©å·¥å…·ã€å¸¸ç”¨å·¥å…·)</span>
</span></span><span class=line><span class=cl>â”‚   â”œâ”€â”€ desktopEnv/         <span class=c1># æ¡Œé¢ç¯å¢ƒ (GNOME, Cosmicã€Wayfireã€Hyprlandã€KDEç­‰)</span>
</span></span><span class=line><span class=cl>â”‚   â”œâ”€â”€ ide-editor/         <span class=c1># ç¼–ç¨‹å·¥å…· (VSCode, Zed, Helixã€ClaudeCodeã€GeminiCli ç­‰)</span>
</span></span><span class=line><span class=cl>â”‚   â”œâ”€â”€ lang-sdk-lsp/       <span class=c1># ç¼–ç¨‹è¯­è¨€ SDK ä¸ LSP æœåŠ¡</span>
</span></span><span class=line><span class=cl>â”‚   â””â”€â”€ service/            <span class=c1># ç³»ç»ŸæœåŠ¡ (Docker, SSH, æ•°æ®åº“, æ‰“å°ç­‰)</span>
</span></span><span class=line><span class=cl>â”œâ”€â”€ system-setting/         <span class=c1># å…¨å±€ç³»ç»Ÿçº§åˆ«è®¾ç½®</span>
</span></span><span class=line><span class=cl>â”‚   â”œâ”€â”€ bootload.nix        <span class=c1># å¼•å¯¼ç¨‹åºé…ç½® (GRUB/Systemd-boot)</span>
</span></span><span class=line><span class=cl>â”‚   â”œâ”€â”€ font-i8n.nix        <span class=c1># å­—ä½“ä¸å›½é™…åŒ–</span>
</span></span><span class=line><span class=cl>â”‚   â”œâ”€â”€ networking.nix      <span class=c1># ç½‘ç»œä¸é˜²ç«å¢™</span>
</span></span><span class=line><span class=cl>â”‚   â””â”€â”€ theme.nix           <span class=c1># ç³»ç»Ÿä¸»é¢˜ä¸ç¾åŒ–</span>
</span></span><span class=line><span class=cl>â”œâ”€â”€ script/                 <span class=c1># è‡ªåŠ¨åŒ–è„šæœ¬ (ç³»ç»Ÿæ›´æ–°ã€å¤‡ä»½ã€æ¸…ç†)</span>
</span></span><span class=line><span class=cl>â”œâ”€â”€ security/               <span class=c1># æ•æ„Ÿä¿¡æ¯ç®¡ç† (ç§é’¥ã€ä»£ç†é…ç½®ã€å¯†ç ) å¯æŠŠéƒ¨åˆ†nixæ–‡ä»¶æ”¾è¿™é‡Œ æ¯”å¦‚ä¸€äº›æ•æ„Ÿçš„ç¯å¢ƒå˜é‡ åˆ«åç­‰</span>
</span></span><span class=line><span class=cl>â””â”€â”€ static_file/            <span class=c1># é™æ€èµ„æº (å£çº¸ã€è‡ªå®šä¹‰å›¾æ ‡ã€ä¸“ç”¨å­—ä½“)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=2-ç°ä»£-linux-å¿…å¤‡docker-ä¸-flatpak-é…ç½®>2. ç°ä»£ Linux å¿…å¤‡ï¼šDocker ä¸ Flatpak é…ç½®</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=line><span class=cl><span class=p>{</span> <span class=n>pkgs</span><span class=o>,</span> <span class=o>...</span> <span class=p>}:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1># å¼€å¯ Docker</span>
</span></span><span class=line><span class=cl>  <span class=n>virtualisation</span><span class=o>.</span><span class=n>docker</span><span class=o>.</span><span class=n>enable</span> <span class=o>=</span> <span class=no>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=c1># å¼€å¯ Flatpak</span>
</span></span><span class=line><span class=cl>  <span class=n>services</span><span class=o>.</span><span class=n>flatpak</span><span class=o>.</span><span class=n>enable</span> <span class=o>=</span> <span class=no>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=c1># æ”¯æŒ AppImage</span>
</span></span><span class=line><span class=cl>  <span class=n>programs</span><span class=o>.</span><span class=n>appimage</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>enable</span> <span class=o>=</span> <span class=no>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>binfmt</span> <span class=o>=</span> <span class=no>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>environment</span><span class=o>.</span><span class=n>systemPackages</span> <span class=o>=</span> <span class=k>with</span> <span class=n>pkgs</span><span class=p>;</span> <span class=p>[</span> <span class=n>docker-compose</span> <span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=3-å­—ä½“ä¸å›½é™…åŒ–-ä¸­æ–‡ç¯å¢ƒ>3. å­—ä½“ä¸å›½é™…åŒ– (ä¸­æ–‡ç¯å¢ƒ)</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=line><span class=cl><span class=p>{</span> <span class=n>pkgs</span><span class=o>,</span> <span class=o>...</span> <span class=p>}:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>#i18n.defaultLocale = &#34;zh_CN.UTF-8&#34;;</span>
</span></span><span class=line><span class=cl>  <span class=n>i18n</span><span class=o>.</span><span class=n>defaultLocale</span> <span class=o>=</span> <span class=s2>&#34;en_US.UTF-8&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>fonts</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>packages</span> <span class=o>=</span> <span class=k>with</span> <span class=n>pkgs</span><span class=p>;</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=n>source-han-sans</span>  <span class=c1># æ€æºé»‘ä½“</span>
</span></span><span class=line><span class=cl>      <span class=n>source-han-serif</span> <span class=c1># æ€æºå®‹ä½“</span>
</span></span><span class=line><span class=cl>      <span class=n>lxgw-wenkai</span>      <span class=c1># éœé¹œæ–‡æ¥·</span>
</span></span><span class=line><span class=cl>      <span class=n>noto-fonts-emoji</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=n>nerdfonts</span><span class=o>.</span><span class=n>override</span> <span class=p>{</span> <span class=n>fonts</span> <span class=o>=</span> <span class=p>[</span> <span class=s2>&#34;JetBrainsMono&#34;</span> <span class=p>];</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>fontconfig</span><span class=o>.</span><span class=n>defaultFonts</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>emoji</span> <span class=o>=</span> <span class=p>[</span> <span class=s2>&#34;Noto Color Emoji&#34;</span> <span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>monospace</span> <span class=o>=</span> <span class=p>[</span> <span class=s2>&#34;JetBrainsMono Nerd Font&#34;</span> <span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>sansSerif</span> <span class=o>=</span> <span class=p>[</span> <span class=s2>&#34;Source Han Sans SC&#34;</span> <span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>serif</span> <span class=o>=</span> <span class=p>[</span> <span class=s2>&#34;Source Han Serif SC&#34;</span> <span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=4-è¾“å…¥æ³•-fcitx5--é›¾å‡‡æ‹¼éŸ³>4. è¾“å…¥æ³• (Fcitx5 + é›¾å‡‡æ‹¼éŸ³)</h3><p>è¿™ä¸ªçœ‹ä¸æ‡‚ä¹Ÿæ²¡å…³ç³»ï¼Œç…§æŠ„å°±è¡Œäº†ã€‚</p><h4 id=41-ä¸»é…ç½®-fcitx5-rimenix>4.1 ä¸»é…ç½® (<code>fcitx5-rime.nix</code>)</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=line><span class=cl><span class=p>{</span> <span class=n>pkgs</span><span class=o>,</span> <span class=n>username</span><span class=o>,</span> <span class=o>...</span> <span class=p>}:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>let</span>
</span></span><span class=line><span class=cl>  <span class=n>rime-ice</span> <span class=o>=</span> <span class=n>pkgs</span><span class=o>.</span><span class=n>stdenvNoCC</span><span class=o>.</span><span class=n>mkDerivation</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>pname</span> <span class=o>=</span> <span class=s2>&#34;rime-ice&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>version</span> <span class=o>=</span> <span class=s2>&#34;2024.12.12&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>src</span> <span class=o>=</span> <span class=n>pkgs</span><span class=o>.</span><span class=n>fetchFromGitHub</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>owner</span> <span class=o>=</span> <span class=s2>&#34;iDvel&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>repo</span> <span class=o>=</span> <span class=s2>&#34;rime-ice&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>rev</span> <span class=o>=</span> <span class=s2>&#34;2024.12.12&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>hash</span> <span class=o>=</span> <span class=s2>&#34;sha256-2QZdlLGZwWIesbjYTE/2yhM1hHGVVp7jR02bR0oqxV0=&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>installPhase</span> <span class=o>=</span> <span class=s1>&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>      mkdir -p $out/share/rime-data
</span></span></span><span class=line><span class=cl><span class=s1>      rm -rf ./others
</span></span></span><span class=line><span class=cl><span class=s1>      rm -f README.md LICENSE
</span></span></span><span class=line><span class=cl><span class=s1>      rm -rf ./.github
</span></span></span><span class=line><span class=cl><span class=s1>      rm squirrel.yaml weasel.yaml
</span></span></span><span class=line><span class=cl><span class=s1>      rm default.yaml custom_phrase.txt
</span></span></span><span class=line><span class=cl><span class=s1>      cp -r ./* $out/share/rime-data
</span></span></span><span class=line><span class=cl><span class=s1>    &#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=k>in</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>home-manager</span><span class=o>.</span><span class=n>users</span><span class=o>.</span><span class=si>${</span><span class=n>username</span><span class=si>}</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>xdg</span><span class=o>.</span><span class=n>configFile</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;fcitx5/conf/chttrans.conf&#34;</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>force</span> <span class=o>=</span> <span class=no>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>text</span> <span class=o>=</span> <span class=s1>&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>          [Global]
</span></span></span><span class=line><span class=cl><span class=s1>          Engine=OpenCC
</span></span></span><span class=line><span class=cl><span class=s1>          OpenCCS2TProfile=default
</span></span></span><span class=line><span class=cl><span class=s1>          OpenCCT2SProfile=default
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>          [Hotkey]
</span></span></span><span class=line><span class=cl><span class=s1>          0=ControlL+Shift+Alt+L
</span></span></span><span class=line><span class=cl><span class=s1>        &#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>home</span><span class=o>.</span><span class=n>file</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;.local/share/fcitx5/rime&#34;</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>source</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=si>${</span><span class=n>rime-ice</span><span class=si>}</span><span class=s2>/share/rime-data&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>recursive</span> <span class=o>=</span> <span class=no>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>onChange</span> <span class=o>=</span> <span class=s1>&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>          mkdir -p ~/.local/share/fcitx5/rime
</span></span></span><span class=line><span class=cl><span class=s1>          chmod -R u+w ~/.local/share/fcitx5/rime
</span></span></span><span class=line><span class=cl><span class=s1>          rm -f ~/.local/share/fcitx5/rime/*.bin
</span></span></span><span class=line><span class=cl><span class=s1>          rm -f ~/.local/share/fcitx5/rime/build/*
</span></span></span><span class=line><span class=cl><span class=s1>        &#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;.local/share/fcitx5/rime/default.yaml&#34;</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>source</span> <span class=o>=</span> <span class=sr>./rime/default.yaml</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>force</span> <span class=o>=</span> <span class=no>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;.local/share/fcitx5/rime/custom_phrase.txt&#34;</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>force</span> <span class=o>=</span> <span class=no>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>source</span> <span class=o>=</span> <span class=sr>../../../security/file/fcitx5_rime_custom_phrase.txt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>i18n</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>inputMethod</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>type</span> <span class=o>=</span> <span class=s2>&#34;fcitx5&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>enable</span> <span class=o>=</span> <span class=no>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>fcitx5</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>waylandFrontend</span> <span class=o>=</span> <span class=no>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>addons</span> <span class=o>=</span> <span class=k>with</span> <span class=n>pkgs</span><span class=p>;</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>          <span class=n>qt6Packages</span><span class=o>.</span><span class=n>fcitx5-configtool</span>
</span></span><span class=line><span class=cl>          <span class=n>fcitx5-gtk</span>
</span></span><span class=line><span class=cl>          <span class=n>libsForQt5</span><span class=o>.</span><span class=n>fcitx5-qt</span>
</span></span><span class=line><span class=cl>          <span class=n>kdePackages</span><span class=o>.</span><span class=n>fcitx5-qt</span>
</span></span><span class=line><span class=cl>          <span class=n>fcitx5-lua</span>
</span></span><span class=line><span class=cl>          <span class=n>fcitx5-fluent</span>
</span></span><span class=line><span class=cl>          <span class=n>libime</span>
</span></span><span class=line><span class=cl>          <span class=n>librime-lua</span>
</span></span><span class=line><span class=cl>          <span class=n>fcitx5-rime</span>
</span></span><span class=line><span class=cl>          <span class=n>rime-ice</span>
</span></span><span class=line><span class=cl>        <span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>settings</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=n>addons</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>classicui</span><span class=o>.</span><span class=n>globalSection</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=n>Theme</span> <span class=o>=</span> <span class=s2>&#34;FluentLight-solid&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>              <span class=n>DarkTheme</span> <span class=o>=</span> <span class=s2>&#34;FluentLight-solid&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>};</span>
</span></span><span class=line><span class=cl>          <span class=p>};</span>
</span></span><span class=line><span class=cl>          <span class=n>inputMethod</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Groups/0&#34;</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=n>Name</span> <span class=o>=</span> <span class=s2>&#34;Default&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>              <span class=s2>&#34;Default Layout&#34;</span> <span class=o>=</span> <span class=s2>&#34;us&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>              <span class=n>DefaultIM</span> <span class=o>=</span> <span class=s2>&#34;rime&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>};</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Groups/0/Items/0&#34;</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=n>Name</span> <span class=o>=</span> <span class=s2>&#34;rime&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>};</span>
</span></span><span class=line><span class=cl>            <span class=n>GroupOrder</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=s2>&#34;0&#34;</span> <span class=o>=</span> <span class=s2>&#34;Default&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>};</span>
</span></span><span class=line><span class=cl>          <span class=p>};</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>      <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=42-ç¯å¢ƒå˜é‡é…ç½®-fcitx5-sessionvariablesnix>4.2 ç¯å¢ƒå˜é‡é…ç½® (<code>fcitx5-sessionVariables.nix</code>)</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=line><span class=cl><span class=p>{</span> <span class=n>username</span><span class=o>,</span> <span class=o>...</span> <span class=p>}:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>home-manager</span><span class=o>.</span><span class=n>users</span><span class=o>.</span><span class=si>${</span><span class=n>username</span><span class=si>}</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>home</span><span class=o>.</span><span class=n>sessionVariables</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>XMODIFIERS</span> <span class=o>=</span> <span class=s2>&#34;@im=fcitx&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>QT_IM_MODULE</span> <span class=o>=</span> <span class=s2>&#34;fcitx&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>QT_IM_MODULES</span> <span class=o>=</span> <span class=s2>&#34;fcitx;ibus;wayland&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>GTK_IM_MODULE</span> <span class=o>=</span> <span class=s2>&#34;fcitx&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>SDL_IM_MODULE</span> <span class=o>=</span> <span class=s2>&#34;fcitx&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>GLFW_IM_MODULE</span> <span class=o>=</span> <span class=s2>&#34;fcitx&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=5-å¼€å‘ç¯å¢ƒç¤ºä¾‹-åˆ†è¯­è¨€é…ç½®>5. å¼€å‘ç¯å¢ƒç¤ºä¾‹ (åˆ†è¯­è¨€é…ç½®)</h3><p>å»ºè®®å°†ä¸åŒè¯­è¨€çš„é…ç½®æ‹†åˆ†ä¸ºç‹¬ç«‹æ–‡ä»¶ï¼ˆå¦‚ <code>rust.nix</code>, <code>go.nix</code>ï¼‰ï¼Œåœ¨ä¸»é…ç½®ä¸­æŒ‰éœ€å¼•å…¥ã€‚</p><h4 id=51-é€šç”¨-cc-ä¸å›¾å½¢å¼€å‘åŸºç¡€-lang-commonnix>5.1 é€šç”¨ C/C++ ä¸å›¾å½¢å¼€å‘åŸºç¡€ (<code>lang-common.nix</code>)</h4><p>åŒ…å« C/C++ ç¼–è¯‘é“¾ã€ä¸€äº›é€šç”¨çš„å¼€å‘å·¥å…·ã€åŠ GUI å¼€å‘ï¼ˆå¦‚ Flutter/Fyneï¼‰æ‰€éœ€çš„åº•å±‚åº“ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=line><span class=cl><span class=p>{</span> <span class=n>pkgs</span><span class=o>,</span> <span class=n>username</span><span class=o>,</span> <span class=o>...</span> <span class=p>}:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>home-manager</span><span class=o>.</span><span class=n>users</span><span class=o>.</span><span class=si>${</span><span class=n>username</span><span class=si>}</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>home</span><span class=o>.</span><span class=n>packages</span> <span class=o>=</span> <span class=k>with</span> <span class=n>pkgs</span><span class=p>;</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=n>gcc</span>
</span></span><span class=line><span class=cl>      <span class=n>gdb</span>
</span></span><span class=line><span class=cl>      <span class=n>gnumake</span>
</span></span><span class=line><span class=cl>      <span class=n>cmake</span>
</span></span><span class=line><span class=cl>      <span class=n>ninja</span>
</span></span><span class=line><span class=cl>      <span class=n>pkg-config</span>
</span></span><span class=line><span class=cl>      <span class=n>openssl</span>
</span></span><span class=line><span class=cl>      <span class=n>openssl</span><span class=o>.</span><span class=n>dev</span>
</span></span><span class=line><span class=cl>      <span class=n>mesa</span>
</span></span><span class=line><span class=cl>      <span class=n>libglvnd</span><span class=o>.</span><span class=n>dev</span>
</span></span><span class=line><span class=cl>      <span class=n>xorg</span><span class=o>.</span><span class=n>libX11</span><span class=o>.</span><span class=n>dev</span>
</span></span><span class=line><span class=cl>      <span class=n>xorg</span><span class=o>.</span><span class=n>libXext</span><span class=o>.</span><span class=n>dev</span>
</span></span><span class=line><span class=cl>      <span class=n>xorg</span><span class=o>.</span><span class=n>libXi</span><span class=o>.</span><span class=n>dev</span>
</span></span><span class=line><span class=cl>      <span class=n>xorg</span><span class=o>.</span><span class=n>libXrandr</span><span class=o>.</span><span class=n>dev</span>
</span></span><span class=line><span class=cl>      <span class=n>xorg</span><span class=o>.</span><span class=n>libXrender</span><span class=o>.</span><span class=n>dev</span>
</span></span><span class=line><span class=cl>      <span class=n>xorg</span><span class=o>.</span><span class=n>libXcursor</span>
</span></span><span class=line><span class=cl>      <span class=n>xorg</span><span class=o>.</span><span class=n>libXinerama</span>
</span></span><span class=line><span class=cl>      <span class=n>libxkbcommon</span>
</span></span><span class=line><span class=cl>      <span class=n>wayland</span>
</span></span><span class=line><span class=cl>      <span class=n>gtk3</span>
</span></span><span class=line><span class=cl>    <span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>home</span><span class=o>.</span><span class=n>sessionVariables</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>PKG_CONFIG_PATH</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>openssl</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/lib/pkgconfig:</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>libglvnd</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/lib/pkgconfig:</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>mesa</span><span class=si>}</span><span class=s2>/lib/pkgconfig:</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libX11</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/lib/pkgconfig:</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXrandr</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/lib/pkgconfig:</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXrender</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/lib/pkgconfig:</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXcursor</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/lib/pkgconfig:</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXinerama</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/lib/pkgconfig:</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXi</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/lib/pkgconfig:</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXext</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/lib/pkgconfig:</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXfixes</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/lib/pkgconfig:</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>xorgproto</span><span class=si>}</span><span class=s2>/lib/pkgconfig&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>CGO_CFLAGS</span> <span class=o>=</span> <span class=s2>&#34;-I</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>xorgproto</span><span class=si>}</span><span class=s2>/include -I</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libX11</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/include -I</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXrandr</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/include -I</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXrender</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/include -I</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXcursor</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/include -I</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXinerama</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/include -I</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXi</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/include -I</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXext</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/include -I</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXfixes</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/include -I</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>libglvnd</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/include&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>CGO_LDFLAGS</span> <span class=o>=</span> <span class=s2>&#34;-L</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>libglvnd</span><span class=o>.</span><span class=n>dev</span><span class=si>}</span><span class=s2>/lib -L</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libX11</span><span class=si>}</span><span class=s2>/lib -L</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXrandr</span><span class=si>}</span><span class=s2>/lib -L</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXxf86vm</span><span class=si>}</span><span class=s2>/lib -L</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXi</span><span class=si>}</span><span class=s2>/lib -L</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXcursor</span><span class=si>}</span><span class=s2>/lib -L</span><span class=si>${</span><span class=n>pkgs</span><span class=o>.</span><span class=n>xorg</span><span class=o>.</span><span class=n>libXinerama</span><span class=si>}</span><span class=s2>/lib&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=52-rust-ç¯å¢ƒ-rustnix>5.2 Rust ç¯å¢ƒ (<code>rust.nix</code>)</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=line><span class=cl><span class=p>{</span> <span class=n>pkgs</span><span class=o>,</span> <span class=n>username</span><span class=o>,</span> <span class=o>...</span> <span class=p>}:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>home-manager</span><span class=o>.</span><span class=n>users</span><span class=o>.</span><span class=si>${</span><span class=n>username</span><span class=si>}</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>home</span><span class=o>.</span><span class=n>packages</span> <span class=o>=</span> <span class=k>with</span> <span class=n>pkgs</span><span class=p>;</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=n>rustup</span>
</span></span><span class=line><span class=cl>      <span class=n>rustc</span>
</span></span><span class=line><span class=cl>    <span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>home</span><span class=o>.</span><span class=n>sessionVariables</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>RUSTUP_HOME</span> <span class=o>=</span> <span class=s2>&#34;$HOME/.rustup&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>CARGO_HOME</span> <span class=o>=</span> <span class=s2>&#34;$HOME/.cargo&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>RUSTUP_DIST_SERVER</span> <span class=o>=</span> <span class=s2>&#34;https://rsproxy.cn&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>RUSTUP_UPDATE_ROOT</span> <span class=o>=</span> <span class=s2>&#34;https://rsproxy.cn/rustup&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=53-go-ç¯å¢ƒ-golangnix>5.3 Go ç¯å¢ƒ (<code>golang.nix</code>)</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=line><span class=cl><span class=p>{</span> <span class=n>pkgs</span><span class=o>,</span> <span class=n>username</span><span class=o>,</span> <span class=o>...</span> <span class=p>}:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>home-manager</span><span class=o>.</span><span class=n>users</span><span class=o>.</span><span class=si>${</span><span class=n>username</span><span class=si>}</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>home</span><span class=o>.</span><span class=n>packages</span> <span class=o>=</span> <span class=k>with</span> <span class=n>pkgs</span><span class=p>;</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=n>go</span>
</span></span><span class=line><span class=cl>      <span class=n>gopls</span>
</span></span><span class=line><span class=cl>      <span class=n>golangci-lint</span>
</span></span><span class=line><span class=cl>      <span class=n>fyne</span> <span class=c1># ä¾èµ– lang-common.nix å†…çš„å’Œå›¾å½¢ç›¸å…³çš„ä¾èµ–å’Œç¯å¢ƒå˜é‡</span>
</span></span><span class=line><span class=cl>      <span class=n>gofumpt</span>
</span></span><span class=line><span class=cl>    <span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>home</span><span class=o>.</span><span class=n>sessionVariables</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>GOPROXY</span> <span class=o>=</span> <span class=s2>&#34;https://goproxy.cn,direct&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=n>home</span><span class=o>.</span><span class=n>sessionPath</span> <span class=o>=</span> <span class=p>[</span> <span class=s2>&#34;/home/</span><span class=si>${</span><span class=n>username</span><span class=si>}</span><span class=s2>/go/bin&#34;</span> <span class=p>];</span> <span class=c1># å…¶å®æœ€å¥½ä¸€ä¸ªå•ç‹¬çš„nixæ–‡ä»¶ç»Ÿä¸€ç®¡ç† Path</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=54-nodejs--bun--deno-nodenix>5.4 Node.js / Bun / Deno (<code>node.nix</code>)</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=line><span class=cl><span class=p>{</span> <span class=n>pkgs</span><span class=o>,</span> <span class=n>username</span><span class=o>,</span> <span class=o>...</span> <span class=p>}:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>home-manager</span><span class=o>.</span><span class=n>users</span><span class=o>.</span><span class=si>${</span><span class=n>username</span><span class=si>}</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>home</span><span class=o>.</span><span class=n>packages</span> <span class=o>=</span> <span class=k>with</span> <span class=n>pkgs</span><span class=p>;</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=n>nodejs_22</span>
</span></span><span class=line><span class=cl>      <span class=n>pnpm</span>
</span></span><span class=line><span class=cl>      <span class=n>bun</span>
</span></span><span class=line><span class=cl>      <span class=n>deno</span>
</span></span><span class=line><span class=cl>    <span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>home</span><span class=o>.</span><span class=n>sessionVariables</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>PNPM_HOME</span> <span class=o>=</span> <span class=s2>&#34;/home/</span><span class=si>${</span><span class=n>username</span><span class=si>}</span><span class=s2>/.local/share/pnpm&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=n>home</span><span class=o>.</span><span class=n>file</span><span class=o>.</span><span class=s2>&#34;.npmrc&#34;</span><span class=o>.</span><span class=n>text</span> <span class=o>=</span> <span class=s1>&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>      registry=https://registry.npmmirror.com/
</span></span></span><span class=line><span class=cl><span class=s1>      global-bin-dir=/home/</span><span class=si>${</span><span class=n>username</span><span class=si>}</span><span class=s1>/.local/share/pnpm/bin
</span></span></span><span class=line><span class=cl><span class=s1>      store-dir=/home/</span><span class=si>${</span><span class=n>username</span><span class=si>}</span><span class=s1>/.pnpm-store
</span></span></span><span class=line><span class=cl><span class=s1>    &#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=55-python-ä¸-zig>5.5 Python ä¸ Zig</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=line><span class=cl><span class=p>{</span> <span class=n>pkgs</span><span class=o>,</span> <span class=n>username</span><span class=o>,</span> <span class=o>...</span> <span class=p>}:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>home-manager</span><span class=o>.</span><span class=n>users</span><span class=o>.</span><span class=si>${</span><span class=n>username</span><span class=si>}</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>home</span><span class=o>.</span><span class=n>packages</span> <span class=o>=</span> <span class=k>with</span> <span class=n>pkgs</span><span class=p>;</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=n>uv</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=n>python313</span><span class=o>.</span><span class=n>withPackages</span> <span class=p>(</span><span class=n>ps</span><span class=p>:</span> <span class=k>with</span> <span class=n>ps</span><span class=p>;</span> <span class=p>[</span> <span class=n>pip</span> <span class=n>requests</span> <span class=n>tkinter</span> <span class=n>django</span> <span class=p>]))</span>
</span></span><span class=line><span class=cl>      <span class=n>unstable</span><span class=o>.</span><span class=n>zig</span>
</span></span><span class=line><span class=cl>      <span class=n>unstable</span><span class=o>.</span><span class=n>zls</span>
</span></span><span class=line><span class=cl>    <span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=56-ç»Ÿä¸€ç®¡ç†ç¯å¢ƒå˜é‡>5.6 ç»Ÿä¸€ç®¡ç†ç¯å¢ƒå˜é‡</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nix data-lang=nix><span class=line><span class=cl><span class=p>{</span> <span class=n>username</span><span class=o>,</span> <span class=o>...</span> <span class=p>}:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>home-manager</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>users</span><span class=o>.</span><span class=si>${</span><span class=n>username</span><span class=si>}</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>home</span><span class=o>.</span><span class=n>sessionPath</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;$HOME/.cargo/bin&#34;</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;$HOME/go/bin&#34;</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;$HOME/myworkspace/my-opt&#34;</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;$HOME/.local/share/pnpm/bin&#34;</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;$HOME/android_flutter/android-sdk/cmdline-tools/latest/bin&#34;</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;$HOME/android_flutter/android-sdk/platform-tools&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=äº”-ç¤¾åŒºä¸æ±‚åŠ©>äº”ã€ ç¤¾åŒºä¸æ±‚åŠ©</h2><ol><li><strong>GitHub æœç´¢</strong>ï¼šæœç´¢ <code>filename:configuration.nix</code> + <code>å…³é”®è¯</code> æ˜¯æœ€å¥½çš„æŠ„ä½œä¸šæ–¹å¼ã€‚</li><li><strong>Telegram ä¸­æ–‡ç¾¤</strong>ï¼šNixOS ä¸­æ–‡ç¤¾åŒºéå¸¸å‹å¥½ï¼Œé‡åˆ°é—®é¢˜è¯·ç¤¼è²Œæè¿° ï¼Œé€šå¸¸ä¼šæœ‰å¤§ç¥è§£ç­”ã€‚</li><li><strong>å®˜æ–¹ç»´åŸº</strong>ï¼š<a class=link href=https://wiki.nixos.org/ target=_blank rel=noopener>NixOS Wiki</a> æ˜¯æœ€æƒå¨çš„å‚è€ƒèµ„æ–™ã€‚</li><li><strong>ä½¿ç”¨é è°±çš„AI</strong>ï¼šGemini3ç›®å‰ï¼ˆ2025-12ï¼‰å¯¹nixæ”¯æŒè¿˜æ˜¯ä¸é”™çš„ï¼Œå°é—®é¢˜å¯ä»¥æ‰¾ä»–å¤„ç†ã€‚ä½†æ˜¯åˆ«æœŸæœ›å®ƒèƒ½è§£å†³æ‰€æœ‰çš„é—®é¢˜ï¼Œæ›´ä¸è¦æŠŠå¸Œæœ›æ”¾åˆ°é‚£äº›é¥é¥é¢†å…ˆçš„AIå¤§æ¨¡å‹ä¸Šã€‚</li></ol><h2 id=æ€»ç»“>æ€»ç»“</h2><p><strong>æ¸è¿›å¼å…¥é—¨ï¼ŒæŠ„ä½œä¸šä¸è¦æ¬ä½œä¸šã€‚</strong>
å…ˆä¿è¯ç³»ç»Ÿèƒ½ç”¨ï¼ˆDocker + Flatpak + åŸºæœ¬é…ç½®ï¼‰ï¼Œå†è¿½æ±‚çº¯å‡€ï¼ˆå…¨ Nix ç®¡ç†ï¼‰ï¼Œæœ€åå†æŒ‘æˆ˜é«˜çº§æŠ€å·§ï¼ˆè‡ªå®šä¹‰ Overlayã€æ‰“åŒ…ï¼‰ã€‚ç¥ä½ åœ¨ NixOS çš„ä¸–ç•Œé‡Œç©å¾—æ„‰å¿«ï¼</p></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article><a href=/rust/cosmic/><div class=article-details><h2 class=article-title>cosmicæ¡Œé¢å·²ç»å®Œå…¨å¯ç”¨è€Œä¸”éå¸¸ä¼˜ç§€</h2></div></a></article><article><a href=/nixos/nixos-fyne-flutter/><div class=article-details><h2 class=article-title>Nixos ä¸‹go-fyneå’Œflutterç­‰uiå¼€å‘ç¯å¢ƒçš„é…ç½®</h2></div></a></article><article><a href=/nixos/windsurf-in-nixos/><div class=article-details><h2 class=article-title>nixosä¸‹ä½¿ç”¨windsurf ç¼–è¾‘å™¨</h2></div></a></article><article><a href=/linux/cosmic-desktop-alpha5/><div class=article-details><h2 class=article-title>cosmic desktop Alpha 5 åˆä½“éªŒ</h2></div></a></article><article><a href=/nixos/home-manager-china/><div class=article-details><h2 class=article-title>nixos home managerå›½å†…ä½¿ç”¨å°æŠ€å·§</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//xiao-lei-sui-shou-ji.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2022 -
2026 å°ç±»éšæ‰‹è®°</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.34.2>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>